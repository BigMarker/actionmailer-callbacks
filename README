This gem adds the following methods to ActionMailer, similar to ActionController before/after filters:

before_create :log_params, :except => :test_email
after_create  :alert_police, :only => :robbery_alert
before_deliver :apply_stamp, :except => [:postage_prepaid, :test_email]
after_deliver :log_success

before_create is executed even if the mail instantiation process fails due to some error. Since no mail has been created at this point, you can't do that much here, basically it's useful to inspect or log params. You can access the params anywhere via @params instance variable.

This gem is tested only with ActionMailer 2.3.11, gem version dependencies are so strict because I needed it to work only on that specific version. Probably it would work with other versions too, as long as the creation/delivery interface of ActionMailer::Base class is still the same.